@SELECT_ENDING
#DIM LCOUNT
#DIM NO_END
#DIM CHOICE
#DIMS NAME_END, 100

NO_END = 0
VARSET NAME_END
VARSET LOCALS
SPLIT STR:エンディング, "/", LOCALS

PRINTFORML どれを見ますか？
FOR LCOUNT, 0, 60
	SIF LOCALS:LCOUNT == ""
		BREAK
	NO_END = TOINT(EXTSTR(LOCALS:LCOUNT, "", "_") )
	NAME_END:NO_END = %EXTSTR(LOCALS:LCOUNT, "_")%

	PRINTFORM  [{NO_END, 2}] %NAME_END:NO_END%
	;閲覧済み？
	SIF CEVENT(NAME_END:NO_END)
		PRINTFORM （閲覧済）
	PRINTL 
NEXT
PRINTFORML [100]戻る

$INPUT_LOOP
INPUT

CHOICE = RESULT

IF CHOICE == 100
	RETURN 0
ELSEIF CHOICE >= 0 && CHOICE <= 60 && NAME_END:CHOICE != ""
	TRYCALLFORM SINGLE_ENDING_K{NO:TARGET}, NAME_END:CHOICE
ELSE
	GOTO INPUT_LOOP
ENDIF

;すでに閲覧済み
IF CEVENT(NAME_END:CHOICE)
	PRINTL 
	DRAWLINE
	RESTART
ENDIF

;選ばれたENDに対応したフラグをCEVENTで立てる
CALL SET_CEVENT, NAME_END:CHOICE

RETURN 1
