;遥君が你に愛憎を抱いているか判定
;ぶっちゃけYOKUBOと同じく長い判定が連続すると判断したので入れた
@AIZOU, ARG
#FUNCTION

SIF ARG == 0
	ARG = TARGET

SIF CEVENT("『のぞき』見", ARG) && TALENT:ARG:恋慕 && TALENT:ARG:相思相愛 == 0 && CEVENT("前輩の意見", ARG) == 0
	RETURNF 1

RETURNF 0

;-------------------------------------------------
;以降は喘ぎ声を生成するための関数
;六華口上やハナ口上の汎用喘ぎ声を参考、また一部流用、改変させていただいて製作しています
;-------------------------------------------------

;喘ぎ声をランダムで発声させる関数。インサートなどの条件があればいくつかの喘ぎ声を混ぜ合わせる
;回数上限、ループ、ハート要不要は共通になる
;現状加える予定の喘ぎ声は、1.通常(製作済)、2.Ｍ異物（製作済）、3Ｖ異物（製作前、男の娘に膣がつけられるようにならない限り作らない予定）4Ａ異物（製作済）5挿入(製作前)
@MPANT_K57, 回数上限, ARG, ARGS
#FUNCTIONS
#DIMS DYNAMIC 喘ぎ
#DIMS 爱心;ARGSを直接いじってしまうとハートが不要になって以後出なくなるので、そうしないための一時的な変数
#DIM 回数上限
#DIM ループ
#DIMS 連続过滤器;あまり繰り返させたくない言葉にフィルタを掛ける

連続过滤器 = 無
爱心 = %ARGS%
FOR ループ, 0, 回数上限
	
	;アナルに挿入されていた場合
	IF (TEQUIP:ARG:肛用振動棒 || TEQUIP:ARG:浣腸 || INSERT("Ａ挿入", ARG) || GROUPMATCH(SELECTCOM, 2, 9, 14, 33, 70, 71, 72, 73, 74, 75, 136, 142, 143)) && RAND:7 == 0 && 連続过滤器 != "Ａ異物"
		喘ぎ += @"%PANT_K57(ARG, 爱心, "Ａ異物")%"
		;アナルを連続して話さないためにフィルタをかける
		連続过滤器 = Ａ異物
	;尿道に挿入されていた場合
	ELSEIF (INSERT("尿道挿入", ARG) || GROUPMATCH(SELECTCOM, 15, 83, 84, 85, 86, 87, 88, 149, 151)) && RAND:6 == 0 && 連続过滤器 != "尿道異物"
		喘ぎ += @"%PANT_K57(ARG, 爱心, "尿道異物")%"
		;尿道を連続して話さないためにフィルタをかける
		連続过滤器 = 尿道異物
	;口に何か入っていた場合
	ELSEIF (TEQUIP:ARG:接吻 || TEQUIP:ARG:深喉 || TEQUIP:ARG:六九式 || GROUPMATCH(SELECTCOM, 6, 91, 96, 98, 99, 135, 148)) && RAND:5 == 0
		喘ぎ += @"%PANT_K57(ARG, 爱心, "Ｍ異物")%"
	;Ｍ異物と条件が被るものの、キスの時限定
	ELSEIF (TEQUIP:ARG:接吻 || SELECTCOM == 6) && RAND:4 == 0
		喘ぎ += @"%PANT_K57(ARG, 爱心, "接吻")%"
	;膣やアナルに挿入していた場合
	ELSEIF (INSERT("挿入", PLAYER, ARG) || (ASSI && INSERT("挿入", ASSI, ARG)) || GROUPMATCH(SELECTCOM, 120, 121, 122, 125, 126, 127)) && RAND:3 == 0 && 連続过滤器 != "挿入"
		喘ぎ += @"%PANT_K57(ARG, 爱心, "挿入")%"
		;挿入を連続して話さないためにフィルタをかける
		連続过滤器 = 挿入
	;オナホに挿入していた場合
	ELSEIF SELECTCOM == 37 && RAND:2 && 連続过滤器 != "飞机杯挿入"
		喘ぎ += @"%PANT_K57(ARG, 爱心, "飞机杯挿入")%"
		;オナホ挿入を連続して話さないためにフィルタをかける
		連続过滤器 = 飞机杯挿入
	;条件に引っかからなければ汎用を呼び出す
	ELSE
		喘ぎ += @"%PANT_K57(ARG, 爱心, "通常")%"
	ENDIF
	
	;連続して指定されなかった場合、フィルタを解除する
	IF 連続过滤器 != "無"
		IF LOCAL == 3
			連続过滤器 = 無
			LOCAL = 0
		ELSE
			LOCAL++
		ENDIF
	ENDIF
	
	;ハートが必要なときはランダムでどちらにするのか指定する
	IF ARGS == "要" && (ループ == 0 || RAND:2)
		爱心 = %ARGS%
	;ハートが不要な場合
	;回数を繰り返したときはランダムでこちらの方を選択する
	ELSEIF ARGS == "不要" || ループ >= 1
		爱心 = 不要
	;今のところは完全に不要だが後の拡張のため＆構文ミスに気付くためにその他にはエラーをだす
	ELSE
		喘ぎ += "指定の範囲外です"
	ENDIF
NEXT

RETURNF 喘ぎ

;喘ぎ声を生成する関数。ハートを加えるか否かをARGSで指定する。
;喘ぎは使う度に空白にしていくので動的変数として指定
;それぞれのパターンを変数パターンに指定し、そのCASEにあわせて喘ぎ方を変えて行く(予定)
@PANT_K57, ARG, ARGS, パターン, 回数
#FUNCTIONS
#DIM ループ
#DIMS パターン
#DIMS DYNAMIC 喘ぎ
#DIM 回数

FOR ループ, 0, MAX(回数, 1)
	SELECTCASE パターン
	;汎用パターン
	CASE "通常"
		IF PALAM:ARG:欲情 >= PALAMLV:5 && RAND:3
			喘ぎ += @"%TEXTR("あ゛/お゛/あ゛あっ/お゛ほっ/あ゛へっ/はっあ゛っ/あ゛ー/あ゛あっ")%"
		ELSEIF PALAM:ARG:欲情 >= PALAMLV:3 && RAND:2
			喘ぎ += @"%TEXTR("あはっ/んはぁっ/はんっ/あんっ/あっ/はぅっ/んあっ/ひぅっ/ああっ")%"
		ELSE
			喘ぎ += @"%TEXTR("あっ……/ヒィン/んあっ……/あんっ/ひゃぅ……/ふぁ……/はぅん……/んっ……/ひゃっ……/ふぅんっ……/っ……")%"
		ENDIF
	;口に何か入っているとき
	CASE "Ｍ異物"
		;長くなるのでいくつかに分割
		IF RAND:2
			喘ぎ += @"%TEXTR("ふむぅ……/んむっ……/はむぁ……/チュパ……/ペロ……/ジュル……/ん……/んっ、れろ…/れろ…ぁむ…んっ/んっ…、れろ……/ちゅっ、れろっ…ちゅぷっ/んんっ……れろ…/れろ、はむ……んっ")%"
		ELSE
			喘ぎ += @"%TEXTR("んっ、んぐっ…/んん…んぅ……っ/んっ…、んん……/んぐっ、んっ…んっ/んむっ……んっ/んむっ、んん…っ")%"
		ENDIF
	;キスしているとき
	CASE "接吻"
		喘ぎ += @"%TEXTR("ちゅ……/ちゅぷ……/んむっ……/ん……/ちゅっ、ちゅっ…/ちゅ…ちゅ……っ/ちゅっ…、ちゅ……/ちゅっ、ちゅっ…ちゅっ/ちゅぅ……ちゅっ/んちゅっ、ちゅ……っ")%"
	;アナルに何か入っているとき
	CASE "Ａ異物"
		喘ぎ += @"%TEXTR("お尻がっ/あんっ/あぁっ")%"
	;尿道に何か入っているとき
	CASE "尿道異物"
		喘ぎ += "尿道がっ"
	;何かに挿入しているとき
	CASE "挿入"
		IF RAND:2
			喘ぎ += @"%CNAMET(ARG, "二人称")%の"
			IF RAND:2
				IF GROUPMATCH(SELECTCOM, 120, 121, 122)
					喘ぎ += @"%TEXTR("マンコ/ナカ")%"
				ELSEIF GROUPMATCH(SELECTCOM, 125, 126, 127)
					喘ぎ += @"%TEXTR("ケツ/肛門")%"
				ENDIF
			ELSE
				喘ぎ += "ナカ"
			ENDIF
			喘ぎ += "がっ_H_うねってっ"
		ELSE
			喘ぎ += @"%TEXTR("んっ/くっ/ふっ/うっ")%"
		ENDIF
	;オナホに挿入しているとき
	CASE "飞机杯挿入"
		喘ぎ += @"%TEXTR("飞机杯が……/あっ……あまり動かすな……っ")%"
	ENDSELECT
	;ハートが必要な場合
	IF ARGS == "要"
		喘ぎ += "_H_"
	;ハートが不要な場合
	ELSEIF ARGS == "不要"
	;今のところは完全に不要だが後の拡張のため＆構文ミスに気付くためにその他にはエラーをだす
	ELSE
		喘ぎ = "PANT_K57に問題があります"
		RETURNF 喘ぎ
	ENDIF
	;読みやすいように半角スペースをくわえる
	喘ぎ += " "
NEXT

RETURNF 喘ぎ