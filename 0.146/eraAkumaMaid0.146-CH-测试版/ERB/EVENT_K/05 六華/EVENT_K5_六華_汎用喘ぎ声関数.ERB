;-------------------------------------------------
;口上ランダム生成関数
;ARGSは種別
;式中関数として呼び出すのはひとまず保留
;-------------------------------------------------
@KOJO_RAND_K5(ARGS)
#DIM LCOUNT
#DIM LIMIT_MEMO
LOCAL = 0
LOCALS = 
SELECTCASE ARGS
CASE "キス"
	;ムードによる口上変化度合いを決定
	;ムードが150以上
	IF FLAG:ムード >= 150
		LOCAL = 5
	;ムードが120以上なら確定、かつ90未満は範囲外
	ELSEIF FLAG:ムード >= 120 || (FLAG:ムード >= 90 && FLAG:ムード >= RAND:180)
		LOCAL = 4
	;ムードが90以上なら確定、かつ60未満は範囲外
	ELSEIF FLAG:ムード >= 90 || (FLAG:ムード >= 60 && FLAG:ムード >= RAND:180)
		LOCAL = 3
	;ムードが60以上なら確定、かつ30未満は範囲外
	ELSEIF FLAG:ムード >= 60 || (FLAG:ムード >= 30 && FLAG:ムード >= RAND:180)
		LOCAL = 2
	ELSE
		LOCAL = 1
	ENDIF
	;ムードが高い場合の追加口上
	SIF LOCAL >= RAND:4 && LOCAL >= 4
		LOCALS = %TEXTR("ちゅっ/んちゅっ/んっ/んんっ")%%UNICODE(0x2661)%　%LOCALS%
	;ムードがさらに高いと追加口上
	IF LOCAL == 5
		LOCALS = %LOCALS%%TEXTR(@"%CNAME("二人称", "甘え")%…/%CNAME("二人称")%、")%%TEXTR(@"好いておるぞ/大好きじゃ/もっとじゃ…っ/%CNAME("一人称")%とキスして…/%CALLNAME%を愛しとくれ…/%CNAME("二人称", "甘え")%…っ")%%UNICODE(0x2661)%　
	ENDIF
	;長くても2回まで
	LIMIT_MEMO = LIMIT(RAND:LOCAL, 2, 3)
	FOR LCOUNT, 0, LIMIT_MEMO
		;ちゅっちゅ系
		IF RAND:2 == 0
			LOCALS = %LOCALS%%TEXTR("ちゅっ、ちゅっ…/ちゅ…ちゅ……っ/ちゅっ…、ちゅ……/ちゅっ、ちゅっ…ちゅっ/ちゅぅ……ちゅっ/んちゅっ、ちゅ……っ")%
		;んっんっ系
		ELSE
			LOCALS = %LOCALS%%TEXTR("んっ、んっ…っ/んっ、ちゅ、んん…っ/んっ、んん……っ/んん…っ、ん…っ/ん、んんっ、ん…っ/んっ、ぁふっ、ん…っ/んっ、んっ、ちゅ…っ")%
		ENDIF
		;ムードに依存してハートマークである確率が上がる
		IF LOCAL >= RAND:4 && LOCAL >= 4
			LOCALS = %LOCALS%%UNICODE(0x2661)%
		ELSE
			LOCALS = %LOCALS%♪
		ENDIF
		;行末以外の記号の後に全角スペースを入れる
		SIF LIMIT_MEMO - LCOUNT > 1
			LOCALS = %LOCALS%　
	NEXT
CASE "フェラ"
	;ムードによる口上変化度合いを決定
	;ムードが高いほど深く咥えこんでいることを意識
	;ムードが150以上
	IF FLAG:ムード >= 150
		LOCAL = 5
	;ムードが120以上なら確定、かつ90未満は範囲外
	ELSEIF FLAG:ムード >= 120 || (FLAG:ムード >= 90 && FLAG:ムード >= RAND:180)
		LOCAL = 4
	;ムードが90以上なら確定、かつ60未満は範囲外
	ELSEIF FLAG:ムード >= 90 || (FLAG:ムード >= 60 && FLAG:ムード >= RAND:180)
		LOCAL = 3
	;ムードが60以上なら確定、かつ30未満は範囲外
	ELSEIF FLAG:ムード >= 60 || (FLAG:ムード >= 30 && FLAG:ムード >= RAND:180)
		LOCAL = 2
	ELSE
		LOCAL = 1
	ENDIF
	;ムードが高い場合の追加口上
	SIF LOCAL >= RAND:4 && LOCAL >= 4
		LOCALS = %TEXTR("んぐっ/んむっ/んっ/んんっ")%%UNICODE(0x2661)%　%LOCALS%
	;ムードがさらに高いと追加口上
	IF LOCAL == 5
		LOCALS = %LOCALS%%TEXTR(@"%CNAME("二人称", "甘え")%…/%CNAME("二人称")%、")%%TEXTR(@"気持ちいいかえ/びくびくしておるな…/こんなに脈打って…/こんなに熱く…/%CALLNAME%の舌奉仕…気に入ってくれておるのかえ/%CNAME("二人称", "甘え")%…っ")%%UNICODE(0x2661)%　
	ENDIF
	;長くても2回まで
	LIMIT_MEMO = LIMIT(RAND:LOCAL, 2, 3)
	FOR LCOUNT, 0, LIMIT_MEMO
		;レロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロレロ系
		IF RAND:3 == 0
			LOCALS = %LOCALS%%TEXTR("んっ、れろ…/れろ…ぁむ…んっ/んっ…、れろ……/ちゅっ、れろっ…ちゅぷっ/んんっ……れろ…/れろ、はむ……んっ")%
		;んぐっ系
		ELSEIF RAND:2 == 0
			LOCALS = %LOCALS%%TEXTR("んっ、んぐっ…/んん…んぅ……っ/んっ…、んん……/んぐっ、んっ…んっ/んむっ……んっ/んむっ、んん…っ")%
		;んっんっ系
		ELSE
			LOCALS = %LOCALS%%TEXTR("んっ、んっ…っ/んっ、ちゅ、んん…っ/んっ、んん……っ/んん…っ、ん…っ/ん、んんっ、ん…っ/んっ、ぷはっ、ん…っ/んっ、んっ、ちゅ…っ")%
		ENDIF
		;ムードに依存してハートマークである確率が上がる
		IF LOCAL >= RAND:4 && LOCAL >= 4
			LOCALS = %LOCALS%%UNICODE(0x2661)%
		ELSE
			LOCALS = %LOCALS%♪
		ENDIF
		;行末以外の記号の後に全角スペースを入れる
		SIF LIMIT_MEMO - LCOUNT > 1
			LOCALS = %LOCALS%　
	NEXT
;イラマチオ・ボールギャグ状態を想定
CASE "口制限"
	;ムードによる口上変化度合いを決定
	;ムードが高いほど深く咥えこんでいることを意識
	;ムードが150以上
	IF FLAG:ムード >= 150
		LOCAL = 5
	;ムードが120以上なら確定、かつ90未満は範囲外
	ELSEIF FLAG:ムード >= 120 || (FLAG:ムード >= 90 && FLAG:ムード >= RAND:180)
		LOCAL = 4
	;ムードが90以上なら確定、かつ60未満は範囲外
	ELSEIF FLAG:ムード >= 90 || (FLAG:ムード >= 60 && FLAG:ムード >= RAND:180)
		LOCAL = 3
	;ムードが60以上なら確定、かつ30未満は範囲外
	ELSEIF FLAG:ムード >= 60 || (FLAG:ムード >= 30 && FLAG:ムード >= RAND:180)
		LOCAL = 2
	ELSE
		LOCAL = 1
	ENDIF
	;ムードが高い場合の追加口上
	SIF LOCAL >= RAND:4 && LOCAL >= 4
		LOCALS = %TEXTR("むぐっ/むぐぅっ/ん゛ん゛っ/んぶぅっ")%%UNICODE(0x2661)%　%LOCALS%
	;ムードがさらに高いと追加口上
	IF LOCAL == 5
		LOCALS = %LOCALS%%TEXTR("んんっ/んむ゛っ/んぐぅっ/ぐぶぅっ")%%UNICODE(0x2661)%　
	ENDIF
	;長くても2回まで
	LIMIT_MEMO = LIMIT(RAND:LOCAL, 2, 3)
	FOR LCOUNT, 0, LIMIT_MEMO
		;んぐっ系
		IF RAND:2 == 0
			LOCALS = %LOCALS%%TEXTR("んっ、むぐぅっ…/んんっ…んむぅ…っ/んん゛っ…、ぶぐ、ぅ…/ん゛んっ、っ…ぐぶっ/んむ゛っ……っ/ぐむぅっ、ん゛ん…っ")%
		;んっんっ系
		ELSE
			LOCALS = %LOCALS%%TEXTR("んっ、んっ…っ/んっ、んぐ…っ/んっ、ぐむ……っ/んん…っ、んぐ…っ/んっ、んんぅ゛っ/んっ、んぐむ…っ/んっ、んっ、ごぇぇ…っ")%
		ENDIF
		;ムードに依存してハートマークである確率が上がる
		IF LOCAL >= RAND:4 && LOCAL >= 4
			LOCALS = %LOCALS%%UNICODE(0x2661)%
		ELSE
			LOCALS = %LOCALS%♪
		ENDIF
		;行末以外の記号の後に全角スペースを入れる
		SIF LIMIT_MEMO - LCOUNT > 1
			LOCALS = %LOCALS%　
	NEXT
ENDSELECT
PRINTFORMW 「%LOCALS%」
RETURN 1
