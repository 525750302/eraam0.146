@COM200
;具現
CALL PRINT_TRAIN_NAME(SELECTCOM)

CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:前回コマンド = %STR:今回コマンド%

RETURN 1


@FLAG_COM200, ARG


@SOURCE_COM200, ARG


@TRAIN_MESSAGE_COM200
#DIM LCOUNT
#DIM SELECT_COUNT
#DIM ACTOR

PRINTFORML どうしますか？

VARSET LOCAL
SELECT_COUNT = 0
FOR LCOUNT, 1, CHARANUM
	SELECTCASE LCOUNT
	CASE MASTER, TARGET, ASSI
		SIF STATE("撃沈", LCOUNT)
			CONTINUE
		SIF LCOUNT != MASTER && DITEMTYPE:LCOUNT:TNUM("具現")
			CONTINUE

		IF TALENT:LCOUNT:ふたなり
			PRINTFORML  [ {SELECT_COUNT}] %CALLNAME:LCOUNT%のペニスを引っ込める
			LOCAL:SELECT_COUNT = LCOUNT
			SELECT_COUNT += 1
		ELSEIF TALENT:LCOUNT:オンナ
			PRINTFORML  [ {SELECT_COUNT}] %CALLNAME:LCOUNT%にペニスを生やす
			LOCAL:SELECT_COUNT = LCOUNT
			SELECT_COUNT += 1
		ENDIF
	ENDSELECT
NEXT
PRINTFORML [100] 戻る

CALL INPUT_SELECT, SELECT_COUNT, 100

SELECTCASE RESULT
CASE 100
	TFLAG:コマンドキャンセル = 1
	RETURN 0
CASEELSE
	ACTOR = LOCAL:RESULT

	IF STATE("具現", ACTOR)
		CALL REMOVE_STATE, ACTOR, "具現"
		PRINTFORMW 具現の能力で生やした%CALLNAME:ACTOR%のペニスが消滅した…
	ELSEIF STATE("ペニス陰核化", ACTOR)
		CALL REMOVE_STATE, ACTOR, "ペニス陰核化"
		PRINTFORMW 具現の能力で陰核化していた%CALLNAME:ACTOR%のペニスが復活した！
	ELSEIF TALENT:ACTOR:ふたなり
		CALL ADD_STATE, ACTOR, "ペニス陰核化"
		PRINTFORMW なんと%CALLNAME:ACTOR%のペニスがみるみる小さくなり、クリトリスになってしまった…
		CALL SETFLAG, "ペニス陰核化フラグ", ACTOR
	ELSE
		CALL ADD_STATE, ACTOR, "具現"
		PRINTFORM なんと%CALLNAME:ACTOR%の股間から
		SELECTCASE SIZE("ペニス", ACTOR)
		CASE IS >= 3
			PRINTFORM 凶悪な大きさの
		CASE 2
			PRINTFORM ほれぼれする大きさの
		ENDSELECT
		PRINTFORMW ペニスが凄い勢いで生えてきた！

		CALL SETFLAG, "具現化ＯＮフラグ", ACTOR
		CALL RECORD_SP_EXP, ACTOR
	ENDIF
ENDSELECT
